library(brms)
?icc
knitr::opts_chunk$set(echo = TRUE)
set.seed(666)
alpha = matrix(c(0.001, 0.05, 0.0001, 0.08), ncol = 2, byrow = TRUE)
w = c(45, 55)
t = matrix(seq(10, 40, 10), ncol = 2, byrow = TRUE)
K = c(10, 50, 100)
lambda = function(r = 1:2, j = 1:2) {
alpha_r0 = alpha[r, 1]
alpha_r1 = alpha[r, 2]
return(alpha_r0*exp(alpha_r1*w[j]))
}
p = function(i = 1:2, j = 1:2){
lam1j = lambda(1, j)
lam2j = lambda(2, j)
p0 = exp(-(lam1j + lam2j)*t[i, j])
p1 = (lam1j/(lam1j + lam2j))*(1 - p0)
p2 = (lam2j/(lam1j + lam2j))*(1 - p0)
return(c(p0, p1, p2))
}
Tmatrxi = rmultinom(100, K[1], prob = p(1, 1))
library(rstan)
